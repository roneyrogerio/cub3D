/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   map.c                                              :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: rde-oliv <marvin@42.fr>                    +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2020/05/27 00:25:00 by rde-oliv          #+#    #+#             */
/*   Updated: 2020/05/29 22:30:47 by rde-oliv         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "cub.h"

int mx[24][24]=
{
  {-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1},
  {-1,-1,-1,1,0,0,0,0,0,0,0,0,0,1},
  {-1,-1,-1,1,0,0,0,0,0,0,0,0,0,1},
  {1,1,1,1,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,2,2,2,2,2,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,1},
  {1,0,0,0,0,0,2,2,0,2,2,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,4,4,4,4,4,4,4,0,0,0,0,1},
  {1,4,0,4,0,0,0,0,4,0,0,0,0,1},
  {1,4,0,0,0,0,5,0,4,0,0,0,0,1},
  {1,4,0,4,0,0,0,0,4,0,0,0,0,1},
  {1,4,0,4,4,4,4,4,4,0,0,0,0,1},
  {1,4,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,4,4,4,4,4,0,0,0,0,0,0,1},
  {1,1,1,1,1,1,1,1,1,1,1,1,1,1}
};

void    map_setup(t_core *core)
{
	core->map.size = (core->ht < core->wd ? core->ht : core->wd) / 7;
	core->map.slice = core->map.size;
	core->map.slice /= core->mxht > core->mxwd ? core->mxht : core->mxwd;
	core->map.mgnx = core->wd / 20;
	core->map.mgny = core->ht / 16;
}

void	map(t_core *core)
{
	int	i;
	int	j;
	int x;
	int y;
	int mxx;
	int mxy;

	i = 0;
	j = 0;
	while (i < core->mxwd * core->map.slice && !(j = 0))
	{
		x = core->wd - (core->mxwd * core->map.slice) + i - core->map.mgnx;
		while (j < core->mxht * core->map.slice)
		{
			mxx = (i - (i % core->map.slice)) / core->map.slice;
			mxy = (j - (j % core->map.slice)) / core->map.slice;
			y = core->ht - (core->mxht * core->map.slice) + j - core->map.mgny;
			if (mx[mxy][mxx] >= 0)
				mlx_pixel_put_image(core->img, x, y, mapc(mx[mxy][mxx]), 0.7);
			j++;
		}
		i++;
	}
}
